{"version":3,"file":"countdown.js.module.js","sources":["../src/index.ts"],"sourcesContent":["import mitt, { EventType, Handler } from \"mitt\";\n\n/* Status type */\ntype status = \"running\" | \"paused\" | \"stopped\";\nclass Timer {\n private _interval: number;\n private _stopwatch: boolean;\n private _duration: number = 0;\n private _endTime: number = 0;\n private _pauseTime: number = 0;\n private _status: status = \"stopped\";\n private _timeoutID?: NodeJS.Timeout;\n private _emitter = mitt();\n /**\n  * Creates a new timer\n  * @constructor\n  * @param {number} [time=1000] Set the tics for the timer\n  * @param {boolean} [stopwatch=false] Set the stopwatch module\n  * @example\n  * const Timer = require('@igorkowalczyk/countdown.js')\n  * const timer = new Timer()\n  * @return {Timer}\n  */\n constructor({ interval = 1000, stopwatch = false } = {}) {\n  this._interval = interval;\n  this._stopwatch = stopwatch;\n }\n /**\n  * @function start\n  * @example\n  * const Timer = require('@igorkowalczyk/countdown.js')\n  * const timer = new Timer()\n  * timer.start(duration [, interval])\n  * @returns {object}\n  */\n public start(duration: number, interval?: number) {\n  if (this.status !== \"stopped\") return;\n  if (!duration) {\n   throw new TypeError(\"You need to enter duration\");\n  }\n  this._duration = duration;\n  this._endTime = Date.now() + duration;\n  this._changeStatus(\"running\");\n  this._emitter.emit(\"tick\", this._stopwatch ? 0 : this._duration);\n  this._timeoutID = setInterval(this.tick, interval || this._interval);\n }\n\n /**\n  * @function stop\n  * @example\n  * const Timer = require('@igorkowalczyk/countdown.js')\n  * const timer = new Timer()\n  * timer.stop()\n  * @returns {object}\n  */\n public stop() {\n  if (this._timeoutID) clearInterval(this._timeoutID);\n  this._changeStatus(\"stopped\");\n }\n\n /**\n  * @function pause\n  * @example\n  * const Timer = require('@igorkowalczyk/countdown.js')\n  * const timer = new Timer()\n  * timer.pause()\n  * @returns {object}\n  */\n public pause() {\n  if (this.status !== \"running\") return;\n  this._pauseTime = Date.now();\n  this._changeStatus(\"paused\");\n }\n\n /**\n  * @function resume\n  * @example\n  * const Timer = require('@igorkowalczyk/countdown.js')\n  * const timer = new Timer()\n  * timer.resume()\n  * @returns {object}\n  */\n public resume() {\n  if (this.status !== \"paused\") return;\n  this._endTime += Date.now() - this._pauseTime;\n  this._pauseTime = 0;\n  this._changeStatus(\"running\");\n }\n\n /**\n  * @private\n  * @returns {object}\n  */\n private _changeStatus(status: status) {\n  this._status = status;\n  this._emitter.emit(\"statusChanged\", this.status);\n }\n\n /**\n  * @private\n  * @returns {object}\n  */\n private tick = () => {\n  if (this.status === \"paused\") return;\n  if (Date.now() >= this._endTime) {\n   this.stop();\n   this._emitter.emit(\"tick\", this._stopwatch ? this._duration : 0);\n   this._emitter.emit(\"done\");\n  } else {\n   this._emitter.emit(\"tick\", this.time);\n  }\n };\n\n /**\n  * @function time\n  * @example\n  * const Timer = require('@igorkowalczyk/countdown.js')\n  * const timer = new Timer()\n  * timer.time() // Returns current time in ms\n  * @returns {string}\n  */\n get time() {\n  if (this.status === \"stopped\") return 0;\n  const time = this.status === \"paused\" ? this._pauseTime : Date.now();\n  const left = this._endTime - time;\n  return this._stopwatch ? this._duration - left : left;\n }\n\n /**\n  * @function duration\n  * @example\n  * const Timer = require('@igorkowalczyk/countdown.js')\n  * const timer = new Timer()\n  * timer.duration() // Return the total duration of the timer in ms\n  * @returns {string}\n  */\n get duration() {\n  return this._duration;\n }\n\n /**\n  * @function status\n  * @example\n  * const Timer = require('@igorkowalczyk/countdown.js')\n  * const timer = new Timer()\n  * timer.status() // return running, paused or stopped\n  * @returns {string}\n  */\n get status() {\n  return this._status;\n }\n\n public on(eventName: EventType, handler: Handler<any>) {\n  this._emitter.on(eventName, handler);\n }\n\n public off(eventName: EventType, handler: Handler<any>) {\n  this._emitter.off(eventName, handler);\n }\n}\n\nexport default Timer;\n"],"names":["Timer","constructor","interval","stopwatch","_interval","_stopwatch","_duration","_endTime","_pauseTime","_status","_timeoutID","_emitter","mitt","tick","status","Date","now","stop","emit","time","start","duration","TypeError","_changeStatus","setInterval","clearInterval","pause","resume","left","on","eventName","handler","off"],"mappings":"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"}